<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Cherenkov times · KM3io.jl</title><meta name="title" content="Cherenkov times · KM3io.jl"/><meta property="og:title" content="Cherenkov times · KM3io.jl"/><meta property="twitter:title" content="Cherenkov times · KM3io.jl"/><meta name="description" content="Documentation for KM3io.jl."/><meta property="og:description" content="Documentation for KM3io.jl."/><meta property="twitter:description" content="Documentation for KM3io.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="KM3io.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/rootfiles/">ROOT Files</a></li><li><a class="tocitem" href="../../manual/multi-threading/">Multi-Threading</a></li><li><a class="tocitem" href="../../manual/detector/">Detector and its Components</a></li><li><a class="tocitem" href="../../manual/calibration/">Calibration</a></li><li><a class="tocitem" href="../../manual/coordinates/">Coordinates</a></li><li><a class="tocitem" href="../../manual/auxfiles/">Auxiliary Files</a></li><li><a class="tocitem" href="../../manual/tools/">Tools</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../online_data/">Online data</a></li><li><a class="tocitem" href="../offline_data/">Offline data</a></li><li class="is-active"><a class="tocitem" href>Cherenkov times</a></li><li><a class="tocitem" href="../orientations/">Orientations</a></li><li><a class="tocitem" href="../controlhost/">Accessing Live Data</a></li><li><a class="tocitem" href="../hdf5/">HDF5</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Cherenkov times</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Cherenkov times</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://git.km3net.de/common/KM3io.jl" title="View the repository"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">Repository</span></a><a class="docs-navbar-link" href="https://git.km3net.de/common/KM3io.jl/blob/main/docs/src/examples/cherenkov_times.md#L" title="Edit source"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Cherenkov-times"><a class="docs-heading-anchor" href="#Cherenkov-times">Cherenkov times</a><a id="Cherenkov-times-1"></a><a class="docs-heading-anchor-permalink" href="#Cherenkov-times" title="Permalink"></a></h1><p>In this example, we will pick the best reconstructed muon (from the Jpp muon reconstruction chain <code>JMuon</code>) in each event and calculate the Cherenkov hit time residuals for each triggered hit.</p><p>We open the a sample file from the <code>KM3NeTTestData</code> package:</p><pre><code class="language-julia hljs">using KM3io, KM3NeTTestData

f = ROOTFile(datapath(&quot;offline&quot;, &quot;mcv6.0.gsg_muon_highE-CC_50-500GeV.km3sim.jterbr00008357.jorcarec.aanet.905.root&quot;))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ROOTFile{OfflineTree (140 events)}</code></pre><p>Each event holds a vector of reconstructed tracks (<code>Vector{Trk}</code>) behind the <code>.trks</code> field. This vector contains different stages of reconstruction results from a variety of reconstruction algorithms (<code>JMuon</code>, <code>JShower</code>, <code>aashower</code> etc.). <code>KM3io.jl</code> exports helper functions to pick the best reconstructed track for a given reconstruction algorithm. The logic is based on the reference implementation in <a href="https://git.km3net.de/common/km3net-dataformat/-/blob/master/tools/reconstruction.hh">KM3NeT DataFormat tools</a>. The function <code>bestjppmuon()</code> can be used to select the best reconstructed <code>JMuon</code> for a given event:</p><pre><code class="language-julia hljs">evt = f.offline[1]
best_muon = bestjppmuon(evt)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Trk (Reconstructed track)
  id: 1
  pos: Position{Float64}(472.387, 526.142, 198.522)
  dir: Direction{Float64}(0.141, 0.986, 0.087)
  t: 5.8796099548102595e7
  E: 544.9525806125414
  len: 0.0
  lik: 40.55672709261793
  rec_type: 4000
  rec_stages: Int32[1, 2, 5, 3, 5, 4]
  fitinf: FitInformation([0.014885871185356527, 0.010385140089653992, -40.55672709261793, 21.0, 544.9525806125414, 62.53353460788458, 3.9927948910593534, 14.0, 0.0, 8.658344340729155, 45.03600640024326, 0.0, 0.0, 1501.6459845444228, -60.9373245973645, 602.0, 18.0])</code></pre><p>We now use this track as a seed to calculate the Cherenkov photon (see <a href="../../api/#KM3io.CherenkovPhoton"><code>CherenkovPhoton</code></a>) parameters using <a href="../../api/#KM3io.cherenkov"><code>cherenkov()</code></a> for each hit triggered hit in the event. To select only triggered hits, we use the <a href="../../api/#KM3io.triggered"><code>triggered()</code></a> function together withe <code>filter()</code> which returns a new vector of triggered hits:</p><pre><code class="language-julia hljs">cherenkov(best_muon, filter(triggered, evt.hits))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">18-element Vector{CherenkovPhoton}:
 CherenkovPhoton(27.456056524385705, 40.873619315665835, 23.01132932189433, 5.879636441354458e7, -3.3185445815324783, -0.6308750235550006, Direction{Float64}(-0.528, 0.839, -0.133))
 CherenkovPhoton(19.589541083469918, 29.162798528739554, 34.066894977706106, 5.879634739559217e7, -3.233592174947262, -0.5615835242962758, Direction{Float64}(-0.103, 0.816, -0.569))
 CherenkovPhoton(10.86335249693415, 16.17218896884205, 44.610162820726465, 5.879632277897501e7, -13.470975004136562, -0.7747565822537275, Direction{Float64}(-0.274, 0.833, -0.481))
 CherenkovPhoton(10.958658115674492, 16.31406970745347, 44.59234480366246, 5.879632337250174e7, -12.580501735210419, -0.12671424342178933, Direction{Float64}(-0.270, 0.832, -0.484))
 CherenkovPhoton(10.944182695875304, 16.29252026178632, 44.40568465253136, 5.879632265069598e7, 3.0913040190935135, -0.9323746132442533, Direction{Float64}(-0.281, 0.833, -0.476))
 CherenkovPhoton(11.17928745250317, 16.642518897357846, 44.22007515662778, 5.8796323642327406e7, 15.824672594666481, 0.13091951330569712, Direction{Float64}(-0.282, 0.833, -0.476))
 CherenkovPhoton(10.90295605293336, 16.23114647681559, 44.79747555408915, 5.8796323675116315e7, 23.333883680403233, 0.21074029444645023, Direction{Float64}(-0.280, 0.833, -0.477))
 CherenkovPhoton(10.834690812223172, 16.129520540155593, 44.741227103812335, 5.879632301979044e7, 35.40920955687761, -0.5058063194444712, Direction{Float64}(-0.276, 0.833, -0.480))
 CherenkovPhoton(38.84032185176909, 57.82128719239538, -7.3748303011806655, 5.879634105250908e7, 2.452490918338299, -0.869871832680696, Direction{Float64}(-0.498, 0.841, -0.212))
 CherenkovPhoton(28.22562353198971, 42.01926777682648, 4.187186042072117, 5.879630689544618e7, 0.01255381852388382, 0.01080998510609144, Direction{Float64}(-0.205, 0.827, -0.524))
 CherenkovPhoton(14.785344110263079, 22.01082759562596, 20.557497574678035, 5.8796269418408036e7, 1.031591959297657, -0.8687222096306455, Direction{Float64}(-0.495, 0.841, -0.216))
 CherenkovPhoton(14.88094434135218, 22.153146921365803, 20.51061784167785, 5.879626991701378e7, 6.563986226916313, -0.3270806917438915, Direction{Float64}(-0.494, 0.841, -0.220))
 CherenkovPhoton(15.035038797101658, 22.382546147629952, 20.413422353617566, 5.8796270648541935e7, 10.363458067178726, 0.45681008948052304, Direction{Float64}(-0.495, 0.841, -0.217))
 CherenkovPhoton(35.48962576204839, 52.8331317997193, -2.014094840107113, 5.879633597758977e7, 1.9564102292060852, -0.4138351012632555, Direction{Float64}(0.234, 0.770, -0.594))
 CherenkovPhoton(35.32252555236435, 52.58437100801102, -1.7938275339033325, 5.879633556747952e7, 3.269520476460457, -0.8429145215271237, Direction{Float64}(0.235, 0.770, -0.594))
 CherenkovPhoton(25.877763469142074, 38.52402663285318, 9.45499183787367, 5.8796308381212674e7, -0.5812126770615578, -0.9686719491474437, Direction{Float64}(0.275, 0.763, -0.585))
 CherenkovPhoton(26.084505456694867, 38.83180183313701, 9.19462645688342, 5.8796308929165296e7, 2.361834704875946, -0.39414201377088814, Direction{Float64}(0.278, 0.763, -0.584))
 CherenkovPhoton(17.507053914837176, 26.062615963014814, 19.40524417300149, 5.8796284221979275e7, 1.8830207213759422, -0.9165095376090588, Direction{Float64}(0.355, 0.749, -0.559))</code></pre><p>To obtain more statistics, we iterate through all the events and calculate the Cherenkov time residuals for each set of hits based on the best reconstruction track. We fill the time residuals in a 1D histogram using the <a href="https://github.com/Moelf/FHist.jl">FHist</a> package.</p><div class="admonition is-info" id="Note-6805e271a8e9e177"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-6805e271a8e9e177" title="Permalink"></a></header><div class="admonition-body"><p>This example uses <a href="https://github.com/KristofferC/PGFPlotsX.jl">PGFPlotsX</a> which is a wrapper for the LaTeX library PGFPlots. Feel free to adapt the example to use your favourite plotting library.</p></div></div><pre><code class="language-julia hljs">using KM3io, KM3NeTTestData
using FHist
using PGFPlotsX

f = ROOTFile(datapath(&quot;offline&quot;, &quot;mcv6.0.gsg_muon_highE-CC_50-500GeV.km3sim.jterbr00008357.jorcarec.aanet.905.root&quot;))
Δts = Hist1D(; counttype=Int, binedges=-10:50)

for evt ∈ f.offline
    m = bestjppmuon(evt)
    cherenkov_photons = cherenkov(m, filter(triggered, evt.hits))
    for cp ∈ cherenkov_photons
        push!(Δts, cp.Δt)
    end
end

axis = @pgf Axis(
    {
        ybar, const_plot, grid,
        xlabel=raw&quot;\Delta t / ns&quot;,
        ylabel=&quot;counts&quot;,
    },
    PlotInc(Coordinates(bincenters(Δts), bincounts(Δts)), raw&quot;\closedcycle&quot;)
)
axis</code></pre><p><a href="../cherenkov.pdf">[.pdf]</a>, <a href="../cherenkov.tex">[generated .tex]</a></p><p><img src="../cherenkov.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../offline_data/">« Offline data</a><a class="docs-footer-nextpage" href="../orientations/">Orientations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Monday 23 June 2025 13:18">Monday 23 June 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
